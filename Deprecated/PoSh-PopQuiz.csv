Number,Question,PowerShell Command,Get-WmiObject Command,WMIC Command,Native Command,DotNet Command,Variable,GUI Command
1,How do you determine the PowerShell version?,Get-Host,,,,,$PSVersionTable,
2,"Gets default built-in user accounts, local user accounts that were created, and local accounts that were connected to Microsoft accounts.",Get-LocalUser,"Get-WmiObject -Class Win32_UserAccount -Filter ""LocalAccount='True'""",wmic useraccount where localaccount=true list brief,net user,,,
3,"Gets default built-in user accounts, local user accounts that were created, and local accounts that were connected to Microsoft accounts.",Get-LocalGroupMember -Group administrators,,,net localgroup administrators,,,
4,Get AntiVirus Product Information,,Get-WmiObject -Namespace root\SecurityCenter2 -Class AntivirusProduct,,,,,
5,Gets IP addresses and link-layer addresses from ARP/neighbor cache entries.,Get-NetNeighbor,,,arp -a,,,
6,Get the Audit Policy,,,,auditpol /get /category:*,,,
7,Gets the basic input/output services (BIOS) that are installed.,,Get-WmiObject -Class Win32_BIOS,wmic bios list brief,,,,
8,Gets the current date and time.,Get-Date,Get-WmiObject -Class Win32_OperatingSystem,,date,,,
9,Gets logical disk/drive information.,Get-PSDrive,Get-WmiObject -Class Win32_LogicalDisk,wmic LogicalDisk list brief,,,,
10,Gets one or more disks visible to the operating system.,Get-Disk,Get-WmiObject -Class Win32_DiskDrive,wmic DiskDrive list brief,,,,
11,Retrieves the contents of the DNS client cache.,Get-DnsClientCache,,,ipconfig /displaydns,,,
12,Displays driver information in a Windows image. Any unauthorized or unexpected drivers should be investigated.,Get-WindowsDriver -Online -All,Get-WmiObject -Class Win32_Systemdriver,,driverquery /si,,,
13,Gets the environmental variables.,Get-ChildItem Env:,Get-WmiObject -Class Win32_Environment,wmic environment list,set,,,
14,Get Event Log statistics,Get-EventLog -List,,wmic nteventlog list brief,,,,
15,Get a more granular breakdown of Event Log statistics,Get-WinEvent -ListLog *,,,,,,
16,Gets the ports that are forwarded/redirected elsewhere.,,,,netsh interface portproxy show all,,,
17,Retrieves the firewall rules on the endpoint.,Get-NetFirewallRule,,,netsh advfirewall firewall show rule name=all,,,
18,Displays settings that apply to the per-profile configurations of the Windows Firewall with Advanced Security,Get-NetFirewallProfile,,,netsh advfirewall show allprofiles state,,,
19,Gets the local security groups on the endpoint.,Get-LocalGroup,Get-WmiObject -Class Win32_Group -Filter { LocalAccount='True',wmic group list,net localgroup,,,
20,"Gets the contents of the Host file, which is a file that maps hostnames to IP addresses.",,,,type C:\Windows\System32\drivers\etc\hosts,,,
21,Get the mapped network drives.,Get-PSDrive,Get-WmiObject -Class Win32_LogicalDisk,wmic LogicalDisk list brief,net use,,,
22,Gets information about user logon activity.,,Get-WmiObject -Class Win32_NetworkLoginProfile,wmic netlogin list brief,net config workstation | find /I ' name ',,,
23,Gets session information of the computer.,,,,query session,,,
24,Gets information about when a user logged on.,,Get-WmiObject -Class Win32_LoggedOnUser,,query user,,,
25,Gets capacity information of the system memory.,,Get-WmiObject -Class Win32_PhysicalMemoryArray,,,,,
26,Gets performance data information of the system memory.,,Get-WmiObject -Class Win32_PerfRawData_PerfOS_Memory,,,,,
27,Gets physical information of the system memory.,,Get-WmiObject -Class Win32_PhysicalMemory,,,,,
28,Gets utilization information of the system memory.,,Get-WmiObject -Class Win32_OperatingSystem,,,,,
29,Gets information on the motherboard or system board.,,Get-WmiObject -Class Win32_BaseBoard,wmic baseboard list brief,,,,
30,Gets TCP Network Connections,Get-NetTCPConnection,,,netstat -anob -p tcp,,,
31,Gets UDP Network Connections,Get-NetUDPEndpoint,,,netstat -anob -p udp,,,
32,Gets network interface settings.,Get-NetIPAddress,Get-WmiObject -Class Win32_NetworkAdapterConfiguration,wmic nicconfig list brief,ipconfig /all,,,
33,Gets all host protocol statistics for an IPv4 network.,,,,,,,
34,Gets host ICMP statistics for an IPv4 network.,,,,,,,
35,Gets host TCP statistics for an IPv4 network.,,,,,,,
36,Gets host UDP statistics for an IPv4 network.,,,,,,,
37,Gets all host protocol statistics for an IPv6 network.,,,,,,,
38,Gets host TCP statistics for an IPv6 network.,,,,,,,
39,Gets host UDP statistics for an IPv6 network.,,,,,,,
40,Gets host ICMP statistics for an IPv6 network.,,,,,,,
41,Gets information on Plug and Play (PnP) Devices,Get-PnpDevice,Get-WmiObject -Class Win32_PnPEntity,,,,,
42,Gets the Prefetch Files. Prefetch files are great artifacts for forensic investigators trying to analyze applications that have been run on a system. Windows creates a prefetch file when an application is run from a particular location for the very first time. This is used to help speed up the loading of applications,Get-ChildItem C:\Windows\Prefetch -Force,,,dir C:\Windows\Prefetch,,,
43,Gets printer information.,,Get-WmiObject -Class Win32_Printer,,,,,
44,Gets a list of running processes.,Get-Process,Get-WmiObject -Class Win32_Process,wmic process list brief,tasklist /V /FO CSV, [System.Diagnostics.Process]::GetProcesses() ,,
45,Gets information on the CPU Processor.,,Get-WmiObject -Class Win32_Processor,,,,,
46,Gets a list of Restore Points.,Get-ComputerRestorePoint,,,,,,
47,Gets scheduled tasks.,Get-ScheduledTask,,,schtasks /query /V,,,
48,Get screensaver information.,,Get-WmiObject -Class Win32_Desktop,wmic desktop list brief,,,,
49,Gets information on security patches and when they were installed.,Get-HotFix,Get-WmiObject -Class Win32_QuickFixEngineering,wmic qfe list,dism /online /get-packages,,,
50,Gets information on services.,Get-Service,Get-WmiObject -Class Win32_Service,wmic service list brief,sc query state=all, [System.ServiceProcess.ServiceController]::GetServices() ,,
51,Displays with the services hosted in each process.,,,,tasklist /SVC,,,
52,Retrieves information about the SMB sessions that are currently established between the SMB server and the associated clients.,Get-SmbSession,,,net session,,,
53,Gets network shares. The 'net share' command is used to manage file/printer shares.,Get-SmbShare,Get-WmiObject -Class Win32_Share,wmic share,net share,,,
54,Gets installed software.,,Get-WmiObject -Class Win32_Product,wmic product list brief,,,,
55,Gets startup information.,,Get-WmiObject -Class Win32_StartupCommand,wmic startup list brief,,,,
56,Gets consolidated operating system information and properties.,Get-ComputerInfo,Get-WmiObject -Class Win32_ComputerSystem,wmic computersystem list brief,systeminfo,,,msinfo32
57,Gets the Boot Security Policy,Get-SecureBootPolicy,,,,,,
58,"If the hardware supports UEFI Secure Boot, checks if it's enabled. If enabled it will return True, otherwise False. If the hardware doesn't support UEFI Secure boot or is BIOS based, an not supported error will be displayed.",Confirm-SecureBootUEFI,,,,,,
59,Gets USB Device Controller Information.,,Get-WmiObject -Class Win32_USBControllerDevice,,,,,
60,Gets the USB History of devices previously connected.,Get-ItemProperty -Path HKLM:\system\CurrentControlSet\Enum\USBSTOR\*\*,,,,,,
61,Gets the virtual machines from one or more Hyper-V hosts.,Get-VM -VMName *,,,,,,
62,"Gets the virtual network adapters of Hyper-V virtual machine, snapshot, management OS, or of a management OS.",Get-VMNetworkAdapter -VMName *,,,,,,
63,Gets the checkpoints associated with a Hyper-V virtual machine or checkpoint.,Get-VMSnapshot -VMName *,,,,,,
64,Gets the history of threats detected on the computer.,Get-MpThreat,,,,,,
65,Gets active and past malware threats that Windows Defender detected.,Get-MpThreatDetection,,,,,,
66,Gets preferences for the Windows Defender scans and updates.,Get-MpPreference,,,,,,
67,Gets the status of anti-malware software on the computer.,Get-MpComputerStatus,,,,,,
68,"The WS-Management TrustedHosts list is a list of trusted resources for your computer. The TrustedHosts list consists of a comma-separated list of computer names, IP addresses, and fully-qualified domain names. Only members of the Administrators group on the computer have permission to change the list of trusted hosts on the computer. For information about runningWindows PowerShell with administrator permissions, see How to Run as Administrator. To use the IP address of a remote computer in a Windows PowerShell command to connect to the remote computer, the IP address must be in the TrustedHosts list on your computer. This is a requirement of NTLM authentication, which is used whenever a computer is identified by the IP address instead of a computer name.",Get-Item WSMan:\localhost\Client\TrustedHosts,,,,,,
69,The Get-WindowsOptionalFeature cmdlet gets information about all features (operating system features that include optional Windows foundation features) in the Windows Foundation Package or a specified package in the Windows image.,Get-WindowsOptionalFeature -online | Where-Object state -eq enabled,,,,,,
